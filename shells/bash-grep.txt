# Регулярные выражения в bash

См. также [basn-find.md](./bash-find.md)

## Grep in found by name files

:speech_balloon: [regex - Using grep to search files provided by find: what is wrong with find . | xargs grep '...'? | SO](https://stackoverflow.com/questions/1204781/using-grep-to-search-files-provided-by-find-what-is-wrong-with-find-xargs-g)

```bash
find . -type f | xargs fgrep '...'
```

## Поиск группы

sed

```sql
CREATE TABLE `offercalc_fields` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) NOT NULL,
  `price` double NOT NULL,
  `offer_slug` varchar(255) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
```

```
cat sed -nr 's/CREATE TABLE `(.+)`.*/\1/p'
```

`(.+)` - матчит любые символы в кавычках
`.*` - матчит конец строки

Вывод: `offercalc_fields`

http://www.mikeplate.com/2012/05/09/extract-regular-expression-group-match-using-grep-or-sed/

Bash match example:

```bash
x='foo bar bletch'
if [[ $x =~ foo[[:space:]](bar)[[:space:]]bl(.*) ]]
then
    echo The regex matches!
    echo $BASH_REMATCH
    echo ${BASH_REMATCH[1]}
    echo ${BASH_REMATCH[2]}
fi
```

## Поиск текста в файлах в директории рекурсивно

```bash
grep -r "texthere" .
```

http://stackoverflow.com/questions/1987926/how-do-i-grep-recursively

## Рекурсивная замена в файлах

```bash
find . -type f -exec sed -i 's/foo/bar/g' {} +
```

## grep in error output (stderr)

example:

```
nginx -V &> >(grep auth)
```

## Исключить расширения из поиска

grep -nr --exclude=\*.{js,css} keyword

## Возвращение части строки после маркера

Дано:

```
Default vault path:  /path/to/vault
```

Можно получить `/path/to/vault` так: `grep -Po "path:\s*\K.*"`.

`\K` принудительно передвигает маркер начала найденной последовательности.

[regex - grep: group capturing - ClarkZinzow answer - Stack Overflow](https://stackoverflow.com/a/41194927/1760643)